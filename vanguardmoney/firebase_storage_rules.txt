// Firebase Storage Security Rules para VanguardMoney
// Estas reglas deben aplicarse en Firebase Console -> Storage -> Rules

rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    // Permitir lectura de imágenes de perfil a usuarios autenticados
    match /profile_images/{imageId} {
      allow read: if request.auth != null;
      
      // Permitir escritura solo al dueño de la imagen
      // El nombre del archivo debe ser profile_{uid}.jpg
      allow write: if request.auth != null 
        && imageId == 'profile_' + request.auth.uid + '.jpg'
        && resource == null // Solo permitir creación, no actualización
        && request.resource.size < 5 * 1024 * 1024 // Máximo 5MB
        && request.resource.contentType.matches('image/.*'); // Solo imágenes
      
      // Permitir eliminación solo al dueño
      allow delete: if request.auth != null 
        && imageId == 'profile_' + request.auth.uid + '.jpg';
    }
  }
}

/* 
INSTRUCCIONES PARA APLICAR ESTAS REGLAS:

1. Ve a Firebase Console (console.firebase.google.com)
2. Selecciona tu proyecto VanguardMoney
3. Ve a Storage en el menú lateral
4. Haz clic en la pestaña "Rules"
5. Reemplaza las reglas existentes con las reglas de arriba
6. Haz clic en "Publish" para aplicar los cambios

NOTA: Si no tienes Firebase Storage habilitado:
1. Ve a Storage en Firebase Console
2. Haz clic en "Get started"
3. Selecciona una ubicación (preferiblemente cerca de tus usuarios)
4. Luego aplica las reglas de arriba
*/